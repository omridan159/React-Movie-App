{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\DELL\\\\Desktop\\\\REACT MOVIES PROJECT\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"C:\\\\Users\\\\DELL\\\\Desktop\\\\REACT MOVIES PROJECT\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\DELL\\\\Desktop\\\\REACT MOVIES PROJECT\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:\\\\Users\\\\DELL\\\\Desktop\\\\REACT MOVIES PROJECT\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\DELL\\\\Desktop\\\\REACT MOVIES PROJECT\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import{POPULAR_BASE_URL}from'../../config';export var useHomeFetch=function useHomeFetch(searchTerm){var _useState=useState({movies:[]}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var fetchMovies=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(endpoint){var isLoadMore,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setError(false);setLoading(true);isLoadMore=endpoint.search('page');_context.prev=3;_context.next=6;return fetch(endpoint);case 6:_context.next=8;return _context.sent.json();case 8:result=_context.sent;setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{movies:isLoadMore!==-1?[].concat(_toConsumableArray(prev.movies),_toConsumableArray(result.results)):_toConsumableArray(result.results),heroImage:prev.heroImage||result.results[0],currentPage:result.page,totalPages:result.total_pages});});_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](3);setError(true);console.log(_context.t0);case 16:setLoading(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,12]]);}));return function fetchMovies(_x){return _ref.apply(this,arguments);};}();// Fetch popular movies initially on mount\nuseEffect(function(){if(sessionStorage.homeState){setState(JSON.parse(sessionStorage.homeState));setLoading(false);}else{fetchMovies(POPULAR_BASE_URL);}},[]);useEffect(function(){if(!searchTerm){sessionStorage.setItem('homeState',JSON.stringify(state));}},[searchTerm,state]);return[{state:state,loading:loading,error:error},fetchMovies];};","map":{"version":3,"sources":["C:/Users/DELL/Desktop/REACT MOVIES PROJECT/src/components/hooks/useHomeFetch.js"],"names":["useState","useEffect","POPULAR_BASE_URL","useHomeFetch","searchTerm","movies","state","setState","loading","setLoading","error","setError","fetchMovies","endpoint","isLoadMore","search","fetch","json","result","prev","results","heroImage","currentPage","page","totalPages","total_pages","console","log","sessionStorage","homeState","JSON","parse","setItem","stringify"],"mappings":"s1BAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,gBAAT,KAAiC,cAAjC,CAEA,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAC,UAAU,CAAI,eACdJ,QAAQ,CAAC,CAAEK,MAAM,CAAE,EAAV,CAAD,CADM,wCACjCC,KADiC,eAC1BC,QAD0B,8BAEVP,QAAQ,CAAC,KAAD,CAFE,yCAEjCQ,OAFiC,eAExBC,UAFwB,8BAGdT,QAAQ,CAAC,KAAD,CAHM,yCAGjCU,KAHiC,eAG1BC,QAH0B,eAKxC,GAAMC,CAAAA,WAAW,0FAAG,iBAAMC,QAAN,wIAClBF,QAAQ,CAAC,KAAD,CAAR,CACAF,UAAU,CAAC,IAAD,CAAV,CAEMK,UAJY,CAICD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAJD,uCAOYC,CAAAA,KAAK,CAACH,QAAD,CAPjB,6CAO6BI,IAP7B,UAOVC,MAPU,eAQhBX,QAAQ,CAAC,SAAAY,IAAI,wCACRA,IADQ,MAEXd,MAAM,CACJS,UAAU,GAAK,CAAC,CAAhB,8BACQK,IAAI,CAACd,MADb,qBACwBa,MAAM,CAACE,OAD/B,sBAEQF,MAAM,CAACE,OAFf,CAHS,CAMXC,SAAS,CAAEF,IAAI,CAACE,SAAL,EAAkBH,MAAM,CAACE,OAAP,CAAe,CAAf,CANlB,CAOXE,WAAW,CAAEJ,MAAM,CAACK,IAPT,CAQXC,UAAU,CAAEN,MAAM,CAACO,WARR,IAAL,CAAR,CARgB,iFAmBhBd,QAAQ,CAAC,IAAD,CAAR,CACAe,OAAO,CAACC,GAAR,cApBgB,QAsBlBlB,UAAU,CAAC,KAAD,CAAV,CAtBkB,qEAAH,kBAAXG,CAAAA,WAAW,4CAAjB,CAyBA;AACAX,SAAS,CAAC,UAAM,CACd,GAAI2B,cAAc,CAACC,SAAnB,CAA8B,CAC5BtB,QAAQ,CAACuB,IAAI,CAACC,KAAL,CAAWH,cAAc,CAACC,SAA1B,CAAD,CAAR,CACApB,UAAU,CAAC,KAAD,CAAV,CACD,CAHD,IAGO,CACLG,WAAW,CAACV,gBAAD,CAAX,CACD,CACF,CAPQ,CAON,EAPM,CAAT,CASAD,SAAS,CAAC,UAAM,CACd,GAAI,CAACG,UAAL,CAAiB,CACfwB,cAAc,CAACI,OAAf,CAAuB,WAAvB,CAAoCF,IAAI,CAACG,SAAL,CAAe3B,KAAf,CAApC,EACD,CACF,CAJQ,CAIN,CAACF,UAAD,CAAaE,KAAb,CAJM,CAAT,CAMA,MAAO,CAAC,CAAEA,KAAK,CAALA,KAAF,CAASE,OAAO,CAAPA,OAAT,CAAkBE,KAAK,CAALA,KAAlB,CAAD,CAA4BE,WAA5B,CAAP,CACD,CA/CM","sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { POPULAR_BASE_URL } from '../../config';\r\n\r\nexport const useHomeFetch = searchTerm => {\r\n  const [state, setState] = useState({ movies: [] });\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(false);\r\n\r\n  const fetchMovies = async endpoint => {\r\n    setError(false);\r\n    setLoading(true);\r\n\r\n    const isLoadMore = endpoint.search('page');\r\n\r\n    try {\r\n      const result = await (await fetch(endpoint)).json();\r\n      setState(prev => ({\r\n        ...prev,\r\n        movies:\r\n          isLoadMore !== -1\r\n            ? [...prev.movies, ...result.results]\r\n            : [...result.results],\r\n        heroImage: prev.heroImage || result.results[0],\r\n        currentPage: result.page,\r\n        totalPages: result.total_pages,\r\n      }));\r\n    } catch (error) {\r\n      setError(true);\r\n      console.log(error);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  // Fetch popular movies initially on mount\r\n  useEffect(() => {\r\n    if (sessionStorage.homeState) {\r\n      setState(JSON.parse(sessionStorage.homeState));\r\n      setLoading(false);\r\n    } else {\r\n      fetchMovies(POPULAR_BASE_URL);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!searchTerm) {\r\n      sessionStorage.setItem('homeState', JSON.stringify(state));\r\n    }\r\n  }, [searchTerm, state]);\r\n\r\n  return [{ state, loading, error }, fetchMovies];\r\n};\r\n\r\n"]},"metadata":{},"sourceType":"module"}